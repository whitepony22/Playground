<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MP4 to GIF Converter</title>
  <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.12.6/dist/ffmpeg.min.js"></script>
  <style>
    body {
      font-family: sans-serif;
      background: #f5f5f5;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem;
    }
    input, button {
      margin: 1rem 0;
      padding: 0.6rem 1rem;
      font-size: 1rem;
    }
    .output {
      margin-top: 2rem;
    }
    .gif-preview {
      margin-top: 1rem;
      max-width: 100%;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <h2>üéûÔ∏è MP4 to GIF Converter</h2>
  <input type="file" id="uploader" accept="video/mp4" />
  <button id="convertBtn">Convert to GIF</button>
  <div class="output" id="output"></div>

  <script>
    const { createFFmpeg, fetchFile } = FFmpeg;
    const ffmpeg = createFFmpeg({ log: true });

    const uploader = document.getElementById('uploader');
    const convertBtn = document.getElementById('convertBtn');
    const outputDiv = document.getElementById('output');

    convertBtn.onclick = async () => {
      if (!uploader.files[0]) {
        alert('Upload an MP4 file first.');
        return;
      }

      const file = uploader.files[0];

      if (!ffmpeg.isLoaded()) await ffmpeg.load();

      ffmpeg.FS('writeFile', 'input.mp4', await fetchFile(file));

      await ffmpeg.run(
        '-i', 'input.mp4',
        '-vf', 'fps=10,scale=480:-1:flags=lanczos',
        '-c:v', 'gif',
        'output.gif'
      );

      const data = ffmpeg.FS('readFile', 'output.gif');

      const blob = new Blob([data.buffer], { type: 'image/gif' });
      const url = URL.createObjectURL(blob);

      outputDiv.innerHTML = `
        <h3>üéâ Your GIF:</h3>
        <img class="gif-preview" src="${url}" alt="GIF preview"/>
        <br>
        <a href="${url}" download="converted.gif">‚¨áÔ∏è Download GIF</a>
      `;
    };
  </script>
</body>
</html>
